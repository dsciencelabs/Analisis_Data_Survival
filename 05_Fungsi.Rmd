# Fungsi dalam R 

Suatu fungsi *(function)* dalam lingkungan pemrograman adalah satu set instruksi untuk melaksanakan tugas-tugas tertentu. Seorang programmer membangun sebuah fungsi untuk menghindari pengulangan tugas yang sama atau mengurangi kompleksitas. 

```{r fungsi,echo=FALSE, fig.cap='Cara Kerja Fungsi', tidy=FALSE, out.width='100%', fig.align='center'}
library(knitr)
img1_path <- "./images/Bab5/functionmachine.gif"
include_graphics(img1_path)
```

Dari gambar \@ref(fig:fungsi) diperlihatkan bahwa:

* Jika $x=5$ adalah masukan *(input)*
* Diberikan instruksi (fungsi) $f(x)=x+3$, yang disebut badan progam *(body)*
* Maka $y=8$ aadalah keluaran *(output)*

Sehingga, komponen yang harus terkandung didalam fungsi adalah:

* $f$ adalah `Nama Fungsi` yang digunakan untuk menjalan fungsi (perintah) pada program tertentu.
* $x$ adalah `Masukan`, tetapi mungkin saja tidak ada argumen.
* $x+3$ adalah `Badan Program` yang mendefinisikan fungsi yang dilakukan.
* `Keluaran` adalah perintah pengembalian satu atau lebih nilai dan mungkin saja tidak memuat pengembalian nilai.

Dalam berbagai kesempatan, programer diharapkan untuk mampu membangun fungsi (algoritma) sendiri dikarenakan tugas tertentu tidak dapat diselesaikan dengan fungsi yang sudah ada atau tidak ditemukannya fungsi dalam bahasa pemoragraman yang sedang digunakan. Pembentukan fungsi ini akan dibagi menjadi dua, yaitu fungsi dengan satu-argumen dan fungsi dengan multi-argument.

## Fungsi Satu Argumen 

Fungsi menerima nilai dan mengembalikan kuadrat dari suatu nilai. Berikut ini, dilampirkan struktur penulisan suatu fungsi dengan satu argumen secara garis besar: 

```
nama.fungsi <- function(argumen)
  {
     perhitungan perintah yang dilakukan terhadap argumen
     beberapa kode lain
  } 
```

### Fungsi Kuadrat 

Jika diberikan suatu vector $x=1,2,3,\cdots, n$, maka nilai $x^2$ dapat dihitung dengan fungsi berikut;

```{r}
masukan=c(1:5)                               # nilai x awal (1,2,3,4,5)

x_kuadrat <- function(x)                     # nama fungsi dan argumen
   {                                         # pembukaan fungsi
    x*x                                      # perintah yang dilakukan 
   }                                         # penutupan fungsi

x_kuadrat(masukan)                           # menggunakan fungsi
cat("Hasil kuadrat:",x_kuadrat(masukan))     # menggunakan fungsi 
```
atau,

```{r}
masukan=c(1:5)                               # nilai x awal (1,2,3,4,5)

x_kuadrat <- function(x)                     # nama fungsi dan argumen
   {                                         # pembukaan fungsi
    keluaran = x^2                           # perintah yang dilakukan 
    return(cat("Hasil kuadrat:",keluaran))   # print hasil dengan komentar
   }                                         # penutupan fungsi

x_kuadrat(masukan)                           # menggunakan fungsi
```

### Fungsi Akar 

Jika diberikan suatu vector adalah kelipatan 9 dari 3 sampai 27, maka nilai $\sqrt[3]{x}$  dapat dihitung dengan fungsi berikut;

```{r}
masukan = seq(from=3, to=27, by = 9)         # kelipatan 9 dari 3 sampai 27

akar <- function(x)                          # nama fungsi dan argumen
   {                                         # pembukaan fungsi
    x^(1/3)                                  # perintah yang dilakukan 
   }                                         # penutupan fungsi

akar(masukan)                                # menggunakan fungsi
```


### Nilai Rerata 

Jika diberikan suatu vector adalah 100 sampel acak dengan rata-rata 160 dan standar deviasi 15, maka nilai rata-ratanya $\bar{x}$ dapat dihitung dengan fungsi berikut;

```{r}
masukan = rnorm(100, mean=160, sd=15)        # 100 sampel,mean=160, dan sd=15 

rerata<- function(x)                         # nama fungsi dan argumen   
{                                            # pembukaan fungsi
  sum(x)/length(x)                           # perintah yang dilakukan 
}                                            # penutupan fungsi

rerata(masukan)                              # menggunakan fungsi
```

### Konversi Persen

Misalkan anda ingin menyajikan angka pecahan sebagai nilai persentase, dibulatkan dengan baik ke dalam dua digit desimal. Berikut cara mencapainya:

* Kalikan bilangan pecahan dengan 100.
* Bulatkan hasilnya ke satu tempat desimal: Anda dapat menggunakan fungsi `round()` untuk melakukan ini.
* Tempelkan tanda persentase setelah angka yang dibulatkan dengan mengunakan fungsi `paste()` 
* Cetak hasilnya: dengan menggunakan `print()`. 

Sebenarnya, akan sangat mudah menerjemahkan langkah-langkah ini ke dalam skrip R berikut ini:

```{r}
x <- c(0.8765, 0.4321, 0.1234, 0.05678)
persen <- round(x*100, digits = 2)
a <- paste(persen, "%")
print(a)
```

Untuk membuat skrip ini menjadi sebuah fungsi, Anda perlu melakukan beberapa hal berikut: 

```{r}
x <- c(0.8765, 0.4321, 0.1234, 0.05678)

persen <- function(x)
  {
    persen_2digit <- round(x * 100, digits = 2)
    keluaran <- paste(persen_2digit, "%")
     return(keluaran)
}

persen(x)
```


## Simpan Fungsi

Jika anda menyimpan skrip ini sebagai file `.R`: misalnya, [`percent.R`](https://github.com/dsciencelabs/Algoritma_Pemrograman_R/blob/main/persen.R) ke komputer/PC anda dalam sebuah folder. Kemudian, kapapun anda dapat memanggil skrip ini di konsol dengan perintah berikut: 

```{r}
x <- c(0.8765, 0.4321, 0.1234, 0.05678)
source('persen.R')                   # pastikan direktori anda benar
persen(x)                                   # menggunakan fungsi anda 
```

**Catatan:** Sebenarnya sudah ada library yang dapat anda gunakan untuk mengubah suatu array di R yaitu:

```{r}
library(scales)
percent(x,accuracy=0.01)
```

## Fungsi Multi Argumen

Kita dapat menulis fungsi dengan lebih dari satu argumen. Berikut Ini adalah fungsi langsung mengalikan dua variabel. 

```
nama.fungsi <- function(argumen1, argumen2,...., argumen_n) 
    {
     perhitungan perintah yang dilakukan terhadap argumen
     beberapa kode lain
    }	
```


### Luas & Keliling

Misalkan anda ingin menghitung luas dan keliling suatu persegi (panjang), diketahui panjang $p$ dan lebarnya $l$. Berikut ini diperlihatkan penyelesaian dengan menggunakan fungsi:

```{r}
luas_keliling <- function(p,l)               # nama fungsi dan argumen
{                                            # pembukaan fungsi
  luas= p*l                                  # menghitung luas
  keliling= 2*(p+l)                          # menghitung keliling
  return (cat(c("Luas:",luas, "\n", 
             "Keliling:",keliling)))  
}                                            # penutupan fungsi
luas_keliling(8,6)                           # menggunakan fungsi
```


### Luas, Keliling dan Volume 

Misalkan anda ingin menghitung luas, keliling dan volume suatu balok (kubus), diketahui panjang $p$, lebarnya $l$, dan tinggi $t$. Berikut ini diperlihatkan penyelesaian dengan menggunakan fungsi:

```{r}
lukelvol <- function(p,l,t)                  # nama fungsi dan argumen
{                                            # pembukaan fungsi
  luas_permukaan = 2*((p*l)+(p*l)+(t*l))     # menghitung luas permukan
  keliling = 2*(p +l)                        # menghitung keliling rusuk
  volume = p*l*t                             # menghitung volume balok (kubus)
  return (cat(c("Luas Permukaan:",
                luas_permukaan, sep = "\n", 
                "Keliling:",keliling,sep="\n", 
                "Volume:",volume)))  
}                                            # penutupan fungsi
lukelvol(6,7,8)                              # menggunakan fungsi
```


### Rerata Frekuensi 

Jika diberikan data berfrekensi sebagai berikut:

|Tinggi Badan| Frekuensi|
|:----------:|:--------:|
| 150        | 16 |
| 155        | 23 |
| 160        | 28 |
| 165        | 40 |
| 170        | 39 |
| 175        | 22 | 
| 180        | 9  |

Maka cara menghitung reratanya dengan bantuan fungsi adalah sebagai berikut:

```{r}
Tinggi<-seq(150,180,5)                       # masukan/argumen 1 
Frek<-c(15,23,28,40,39,22,9)                 # masukan/argumen 2

rerata_frek <- function(x,frek)              # nama fungsi dan argumen
{                                            # pembukaan fungsi
 keluaran=sum(x*frek)/length(frek)           # menghitung rerata frekuensinya
 return(cat("Reratanya:",keluaran))          # print hasil dengan komentar 
}                                            # penutupan fungsi

rerata_frek(Tinggi,Frek)                     # menggunakan fungsi
```


## Fungsi untuk Data Frame

### Normalisasi

Seperti yang telah saya sebutkan sebelumnya, ilmuwan data perlu melakukan banyak tugas berulang. Sebagian besar waktu, kami menyalin dan menempelkan potongan kode berulang-ulang. Contoh lain, normalisasi suatu variabel sangat disarankan sebelum kita menjalankan algoritma pembelajaran mesin. Rumus untuk menormalkan variabel adalah: 

$$\text{Normalisasi}={x-x_{min} / x_{max} - x_{min}}$$

Mari kita buat kerangka data seperti yang telah kita pelajari di dasar-dasar R di bagian terakhir. 

```{r, echo=T, message=FALSE}
set.seed(123)                                # statik random set
a = rnorm(100, 5, 1)                         # 100 bilangan acak normal
b = rnorm(100, 5, 1)                         # 100 bilangan acak normal
c = rnorm(100, 5, 1)                         # 100 bilangan acak normal
df<- data.frame(a,b,c)                       # buat data frame
df                                           # mencetak hasil data frame
typeof(df)
```

Kita sudah mengetahui cara menggunakan fungsi `min()` dan `max()` di R. Oleh karena itu kita dapat menggunakan rumus normalisasi yang kita miliki di atas untuk mendapatkan nilai normalisasi `df` sebagai berikut: 

```{r, echo=T, message=FALSE}
df.norm <- data.frame(  
  a = (df$a -min(df$a))/(max(df$a)-min(df$a)), 
  b = (df$b -min(df$b))/(max(df$b)-min(df$b)),    
  c = (df$c -min(df$c))/(max(df$c)-min(df$c))    
)
df.norm                                       
```

Namun, metode ini rentan terhadap kesalahan penulisan koding. Kita bisa menyalin koding yang hampir serupa, tetapi mungkin saja lupa mengubah variabel yang perlu diganti. Oleh karena itu sebaiknya, kita dapat pertimbangkan penggunaan suatu fungsi untuk melakukannya: 

```{r, echo=T, message=FALSE}
normalize <- function(x){
  norm <- (x-min(x))/(max(x)-min(x))
  return(norm)
}
```

```{r}
df.norm = normalize(df)
df.norm
```


## Latihan

1. Buatlah Fungsi Summary Statistik untuk data berfrekuansi
2. Buatlah Fungsi summary Statistik untuk data frame

**Catatan:** Kumpulkan hasil latihan anda, tidak boleh sama dengan teman mahasiwa lainnya.



